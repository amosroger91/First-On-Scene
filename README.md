<div align="center">
  <img src="assets/logo.png" alt="First-On-Scene Logo" width="300"/>
  <h1 style="margin-top: 5px; margin-bottom: 0px;">First-On-Scene</h1>
  <p style="margin-top: 0px; margin-bottom: 20px;">**Agentic Cyber Incident Response Triage Toolkit**</p>
</div>

## üö® The Triage Agent's Mission: First Responder

Our purpose when responding to a cybersecurity event is to essentially act as the **First Responding Officer** dispatched to a breaking and entering alarm. This mindset defines our duties, constrains our actions, and sets our critical initial goals.

The security systems we deploy‚Äîyour antivirus, EDR solutions, network monitors, and even alert-fatigued client reports‚Äîare our **motion detectors, door alarms, and security cameras.** When an alert is triggered, you, the Triage Agent, are the officer dispatched to assess the immediate scene.

---

## üîç The Responding Officer's Duties vs. The Triage Agent's Duties

A Responding Officer arriving at a crime scene must secure the area and, without contaminating any evidence, quickly determine what happened and what happens next. Our role is a direct parallel: we must maintain a **high degree of skepticism** while seeking deterministic proof.

| Responding Officer Duty | Triage Agent Duty |
| :--- | :--- |
| **Determine if a "crime" has been committed.** | **Determine if a malicious security event has definitively occurred** by separating actual threats from false positives. |
| **Determine if the "crime" is ongoing.** | **Determine if the attack is ongoing and uncontained,** checking for active processes, network connections, and persistence. |
| **Document the crime scene without tampering with the evidence.** | **Document every action taken** to preserve the integrity of the scene. All commands must be logged to `Steps_Taken.txt`. |
| **Interview the witnesses.** | **Gather information from the client** about what they observed or what actions they took. |
| **Check the cameras and logs.** | **Execute `scripts/Gather_Info.ps1` and `scripts/Parse_Results.ps1`** to systematically collect and review system logs and forensic data (`results/Info_Results.txt`). |
| **Determine the required escalation.** | **Make the final decisive call** based on the classification (Event, Incident, or Breach). |

---

## üõ†Ô∏è TOOLING & ARTIFACTS: The Agentic Triage Strategy

The **First-On-Scene** agent operates on a **Structured LLM Triage with Human Vetting** strategy. The core idea is to treat the LLM as a scoring engine for a pre-defined list of forensic indicators derived from collected artifacts.

### 1. The LLM Scoring Engine

The Large Language Model (LLM) is designed to rapidly process and score specific, structured findings generated by `scripts/Parse_Results.ps1`. This determines the severity and category of the alert, serving as the primary input for the Triage Agent's final decision.

| Category | LLM Input/Task | LLM Output Goal (Found in `results/Info_Results.txt`) |
| :--- | :--- | :--- |
| **Persistence** | **Input:** Registry Keys (Run, RunOnce), WMI data. **Task:** "Are there any non-standard entries in these keys?" | List of suspect key/value pairs. |
| **Execution** | **Input:** Prefetch/AmCache data. **Task:** "Identify all processes executed from `$user_profiles` or `C:\Temp`." | List of suspect process paths. |
| **Network** | **Input:** `netstat` and DNS cache output. **Task:** "Are there connections to any IPs with ports 80/443 that are NOT common services (Google, Microsoft, etc.)?" | List of unusual external IPs/Ports. |
| **Credential Access** | **Input:** Security Event Logs (4624/4672). **Task:** "Was a logon event for the temporary admin account immediately followed by a Service logon (type 5)?" | YES/NO finding. |

### 2. Forensic Artifacts Collected by `scripts/Gather_Info.ps1`

The `Gather_Info.ps1` script targets the following artifacts to provide a full, defensible assessment. The current implementation focuses on the artifacts highlighted in **bold**.

#### I. Volatile Data (Memory and Live State)
These artifacts capture the current state and disappear when the device is powered off.
* **Snapshot of Every Running Process:** Details of all active processes.
* **Network Connection Snapshot (netstat):** Current active connections and their owning process.
* *Full Memory (RAM) Image (Future)*: For discovering live malware code and credentials.
* *System Logs (Time-Boxed)*: Windows Event Logs (System, Application, Security, PowerShell, etc.).

#### II. Persistent System Artifacts (Disk & Configuration)
These detail the long-term state and history of the system.
* **Snapshot of the Registry (Run Keys):** Specifically targets persistence and execution evidence.
* *Full Disk Image (Future)*: Complete copy of the hard drive for deep analysis.
* *System and Application Artifacts*: Prefetch Files, Jump Lists, LNK Files, ShellBags, and Windows Error Reporting (WER) Files.
* *Snapshot of the Group Policy*: Configuration settings via GPOs.

#### III. Credential and User Activity & IV. Security/Inventory
* **Security Event Logs (Logons):** Specifically valuable for successful logon (4624) and admin logon (4672) events.
* *Antivirus/EDR Logs*: High-fidelity security logs for context.
* *Credential Manager Data*: Encrypted storage files for saved credentials.
* *Browser History and Related Data*: History, cookies, and download logs.
* *Hardware/Physical Inventory Artifacts*: USB Device History and System Information.

---

## ‚öôÔ∏è CRITICAL GOALS & CONSTRAINTS

### 1. The Call (Final Action)
Your final output **MUST** be a decisive call:
* **`scripts/Problem_Detected.ps1 [REASON_CODE]`**: Call if the classification is a **Breach** or an uncontained **Incident**. The argument **MUST** be a single, capitalized, concise summary (e.g., "MALWARE_DETECTED").
* **`scripts/All_Clear.ps1`**: Call if the classification is a contained **Event** or a False Positive.

### 2. Evidence Integrity (Documentation)
* **FORBIDDEN ACTIONS:** You are **STRICTLY FORBIDDEN** from executing any command not explicitly listed in the 'Tools' section.
* **MANDATORY LOGGING:** You must track every single script execution in `Steps_Taken.txt`.
* **MANDATORY REPORTING:** The final analysis **MUST** be written in structured Markdown to `findings.txt`.

---

## üó∫Ô∏è ORDER OF OPERATIONS (STRICTLY FOLLOWED)

1. Call **`scripts/Gather_Info.ps1`** and log the action to `results/Steps_Taken.txt`.
2. Call **`scripts/Parse_Results.ps1`** and log the action to `results/Steps_Taken.txt`.
3. Review the structured results file (`results/Info_Results.txt`) containing the LLM's forensic scoring.
4. Determine the classification (Event, Incident, or Breach) using the **Cybersecurity Classification Definitions**.
5. **Write the final analysis report to `findings.txt`**.
6. **Final Action:** Call either **`scripts/Problem_Detected.ps1 [REASON_CODE]`** or **`scripts/All_Clear.ps1`**.

---

## üöÄ Quick Run

To quickly execute the Triage Agent, open PowerShell as Administrator and run the following command:

```powershell
$d=(Join-Path $env:TEMP "FOS_Run"); New-Item -ItemType Directory -Path $d -Force | Out-Null; iwr "https://github.com/amosroger91/First-On-Scene/archive/refs/heads/main.zip" -OutFile "$d\m.zip" -UseBasicParsing; Expand-Archive -Path "$d\m.zip" -DestinationPath $d -Force; & "$d\First-On-Scene-main\scripts\Gather_Info.ps1"
```
